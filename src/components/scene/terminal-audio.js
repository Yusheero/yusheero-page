// Класс для управления звуковыми эффектами терминала
export class TerminalAudio {
  constructor(isSoundEnabledRef) {
    this.isSoundEnabled = isSoundEnabledRef;
    
    // Инициализация звуковых эффектов
    this.audioEffects = {
      keypress: [],
      boot: new Audio(),
      error: new Audio(),
      success: new Audio(),
      glitch: new Audio(),
    };
    
    // Создание нескольких вариантов звука клавиш для реалистичности
    for (let i = 0; i < 4; i++) {
      this.audioEffects.keypress.push(new Audio());
    }
    
    this.initAudioEffects();
  }
  
  // Инициализация звуковых эффектов с закодированными данными
  initAudioEffects() {
    // Звуки нажатия клавиш (разные варианты для реалистичности)
    const keypressSounds = [
      'data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAAAwAAAbMAW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW4KCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLz///////////////////////////////////////////8AAAAATGF2YzU4LjEzAAAAAAAAAAAAAAAAJAVlgQAB4AAABLOgeSMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAANcAIIVUAQA1Toy1l1zoGOQJBBJFPnTp06dOgYQEBAQCIiIiIiIiboI5sgoKCgZqampqQUSbJkiRIZsTExMTExMT/+MYxBINMAII/gBQRAx0oAjjoZBQMKqqqqo9Z1XXdVVVVVV7IALdw44MeHA4PB8Hw/P//n35/L8H4/7wdDoQNgYLAgYKCgYGCgoKD/8RDf/+MYxB4OWyoI/gBQTMmRLSsACYPg+D4RCDQIFEQHQI1nVVWRpcpXSozJgMO2p5yxJznJuPVSXLrMXmKZTSWMxJTwV/rYPk45h4Dp',
      'data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAAAwAAAbMAW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW4KCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLz///////////////////////////////////////////8AAAAATGF2YzU4LjEzAAAAAAAAAAAAAAAAJAUigQAB4AAABKygRscAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAAPOJI0/EGQAZJFEqkCYFQCYzIxUomYiGRXRnKszZpmJolJ5DpABgUH1dgAAB/6A4cxaAB/W1qrFUyxGLR6Pmr+1iU0/+MYxA8P0GZEtDGQAa5nMcN5jP//5/Msw3/fzf/Msw73omqmqqqqzluW5bsiIiNd13Ve7ERERESru7u4iIiIiAIAAAAAiImImZr/85m7/+MYxAwOAxZE/DGQASL/wnbvZ3a3/fW+7KlVVVbeqqqqsMxjTEFNRTMuOTkuNaqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpMQU1F',
      'data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAAAwAAAbMAW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW4KCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLz///////////////////////////////////////////8AAAAATGF2YzU4LjEzAAAAAAAAAAAAAAAAJARGgQAB4AAABK/ARUoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAAPguI09EGQAXRMDQUQT87kUWJxEVxYdnk4HQ6HFiqqqqxUKhXKKFQqCiFQriuLYtjWsVjWLYti2NaxbFv7Fsa9j4ti/+MYxA8MWyY4/DGMAQL83//WsY+L8v//sXFxcQAAACYlFxAhEQiEQiIRCIhEhERlMzMzKZmZmVVVVaq7u7v/REREAAAAAADHEmpqdnd3/+MYxBgOEyYo/jDMAaqqqGY000R3u7u7P///8zMzMxERERHu7u7uqqqqnRAREQAAAAAAAAA7KqqqqszMzMxmZmZmZmZmZmZmZkxBTUUz',
      'data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAAAwAAAbMAW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW4KCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLz///////////////////////////////////////////8AAAAATGF2YzU4LjEzAAAAAAAAAAAAAAAAJARAgQAB4AAABKmgLZsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAASAuoo/EGSAYjYKgoJnlkSUDJKRhV9E8ecrKUFG12XWZYQ0tZtlJIEBYOGQOcZAGFQUGw8GQlEJ3/4UYh3//+BmyQO/+MYxAkNyx4w5DGMAY8eOnT4HnIlqSxqqrCqrYtjWLYty3LiA2IiMhAiIiNd13XdlVVVVZjGMYoQERER/bERERHqu7u7u7uZmZmZ/+MYxA4NcxpA/DGMASMzu7u7vc573nPe7v+7Pd3d3ZmZmZnu7u7u7nd3d3REREQIiIiI//+qqqqoZmZmYzMzMzMzMzMzMzMzMzMzTEFN',
    ];
    
    // Установим звуки для разных клавиш
    for (let i = 0; i < this.audioEffects.keypress.length; i++) {
      this.audioEffects.keypress[i].src = keypressSounds[i % keypressSounds.length];
      this.audioEffects.keypress[i].volume = 0.3;
    }
    
    // Звук загрузки/старта
    this.audioEffects.boot.src = 'data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAAAwAABotAW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2t1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1f///////////////////////////////////////////wAAAExhdmM1OC4xMwAAAAAAAAAAAAAAACQF7YEAAeAAAATdoEbvAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAAAAANIAAAAAExBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxDsAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxHYAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFN';
    this.audioEffects.boot.volume = 0.5;
    
    // Звук ошибки
    this.audioEffects.error.src = 'data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAAAwAABn9AW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2t1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1f///////////////////////////////////////////wAAAExhdmM1OC4xMwAAAAAAAAAAAAAAACQFn4EAAeAAAAS5oD7vAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAAAAANIAAAAAExBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxDsAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxHYAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFN';
    this.audioEffects.error.volume = 0.4;
    
    // Звук успешного действия
    this.audioEffects.success.src = 'data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAAAwAABm9AW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2t1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1f///////////////////////////////////////////wAAAExhdmM1OC4xMwAAAAAAAAAAAAAAACQFj4EAAeAAAAS5oC7vAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAAAAANIAAAAAExBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxDsAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxHYAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFN';
    this.audioEffects.success.volume = 0.4;
    
    // Звук глитча
    this.audioEffects.glitch.src = 'data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAADwAAHOgAFBQUGxsbIiIiKSkpMDAwNzc3Pj4+RUVFTExMU1NTWlpaYWFhaGhob29vdnZ2fX19hISEi4uLkpKSmpqaoaGhqKiorq6utbW1vLy8w8PDysrK0dHR2NjY39/f5ubm7e3t9PT0+/v7//8AAAAATGF2YzU4LjEzAAAAAAAAAAAAAAAAJAOPgQABPAAAHOg78xwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/jGMQAAANIAAAAABYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhb/4xjEIAAADSAAAAAWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYW/+MYxDAAAANIAAAAABYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhZMQU1FMy4x/+MYxEoAAANIAAAAADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBMQU1FMy4x/+MYxGAAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxG4AAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMu/+MYxHgAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxIgAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMu/+MYxJIAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxJwAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMu/+MYxKYAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxLAAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMu/+MYxLoAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxMQAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMu/+MYxM4AAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxNgAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMu/+MYxOIAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxOwAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMu/+MYxPYAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxQAAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMu/+MYxQoAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxRQAAANIAAAAAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV';
    this.audioEffects.glitch.volume = 0.4;
  }
  
  // Воспроизведение звука
  playSound(soundName) {
    if (!this.isSoundEnabled.value) return;
    
    try {
      if (soundName === 'keypress') {
        // Для клавиш используем рандомный звук из массива
        this.playRandomKeypress();
      } else if (this.audioEffects[soundName]) {
        const sound = this.audioEffects[soundName];
        sound.currentTime = 0;
        sound.play().catch(err => {
          console.error('Ошибка воспроизведения звука:', err);
        });
      }
    } catch (err) {
      console.error('Ошибка при воспроизведении звука:', err);
    }
  }
  
  // Воспроизведение случайного звука клавиши
  playRandomKeypress() {
    if (!this.isSoundEnabled.value) return;
    
    try {
      const randomIndex = Math.floor(Math.random() * this.audioEffects.keypress.length);
      const sound = this.audioEffects.keypress[randomIndex];
      sound.currentTime = 0;
      sound.play().catch(err => {
        console.error('Ошибка воспроизведения звука клавиши:', err);
      });
    } catch (err) {
      console.error('Ошибка при воспроизведении звука клавиши:', err);
    }
  }
  
  // Включение/выключение звука
  toggleSound(enabled) {
    this.isSoundEnabled.value = enabled;
    
    if (enabled) {
      // Проверим звук при включении
      this.playSound('success');
    }
  }
}

export default TerminalAudio; 